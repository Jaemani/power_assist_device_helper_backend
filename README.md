#### [API 명세서(비개발자용](#api)
#### [DB 스키마 명세서(비개발자용](#db)

# <a name="top"></a>🛠 수리수리 마수리 – 전동보장구 수리이력 관리 시스템

<div align="center">

**2025 Kakao [Tech for Impact](https://techforimpact.io/) 참여 프로젝트**  
전동보장구 사용자의 이동권 보장을 위한  
**QR 기반 수리 이력 관리 시스템**

</div>

---

## 🧩 문제 정의

전동보장구(전동휠체어, 전동스쿠터 등)의 수리는  
① 종이문서, 구두 전달 위주로 이루어지고 있고  
② 수리 이력이 기관, 사용자, 수리기사 간에 공유되지 않으며  
③ 수리 내역이 축적되지 않아 반복적인 고장이 발생하고 있음.

**결과적으로 이동권 침해, 복지예산 비효율, 책임소재 불분명** 등의 문제가 발생하고 있음.

---

## 💡 해결책

**수리수리 마수리**는 다음과 같은 해결책을 제공합니다:

- QR 코드를 통해 장비 고유 식별 및 수리 이력 조회
- 사용자 / 수리기사 / 기관 관리자 각각의 관점에서 설계된 화면
- 수리 항목 체크 → 수리일자 자동기록 → 복지관 통계 연동
- 수리비 예산 산정 및 보증 여부 확인 가능

> 수리기사의 사용 편의성을 높이기 위해 **기록 부담 최소화**,  
> 사용자에게는 **직관적인 이력 확인 UI** 제공

---

## 🖥 시스템 구성도

- **사용자**: 내 장비의 QR코드를 스캔해 수리이력 조회  
- **수리기사**: QR을 스캔하여 수리 항목 체크 → 자동 저장  
- **복지관**: 전체 통계 조회 및 Excel 다운로드 기능 제공 예정  
- **장비별 이력**은 MongoDB에 저장되며, 각 역할별 권한에 따라 접근이 제한됨

---

## 🔧 사용 기술

- Frontend: Flutter Web + Firebase Hosting
- Backend: Next.js App Router + MongoDB
- Authentication: Firebase 전화번호 기반 SMS 인증
- Device Recognition: `uuidv4` 기반 QR 코드 생성
- Deploy: 자체 서버 (AWS 이전 계획)

---

## 🗓 진행 현황

- ✅ 수리 내역 입력 및 저장 기능 구현  
- ✅ QR 스캔 및 장비별 이력 확인 기능  
- ✅ 인증 및 권한 분리 구현
- ✅ 복지관과 연계하여 전동보장구 테스트 사용자 확보, QR 이미지 생성 및 스티거 제작
- 🔄 복지관 실사용 테스트 및 피드백 반영 중  
- 🔄 별따러가자 프로젝트와 연계 예정 (사고 감지 → 수리 연동)

---

## 👤 팀원 역할

| 이름 | 역할 |
|------|------|
| 박유빈 | PM |
| 박현준 | UI/UX |
| 이종준 | Frontend |
| 조성현 | Backend |
| 이재만 | Backend |

---

## 🏛 협력 기관

- 성동장애인종합복지관  
- 별따러가자

---
## 🌍 연계 파트너 – [별따러가자](https://starpickers.imweb.me/)

> **(주)별따러가자**는 AIoT 기반 모빌리티 안전 솔루션 기업으로,  
> **운전 습관 분석**, **사고 탐지 및 검증 모델**, **사회적 비용 절감**을 위한 기술을 개발 중입니다.

전동보장구, 이륜차, 농기계 등 다양한 이동수단에 부착 가능한 모션 센서를 통해  
**운전자의 안전 점수 제공, 사고 경중 판단, 도난 알림** 등의 기능을 제공합니다.

**2023~2024년 충남 예산군 시범사업에서 실사고 6건 전부 탐지**,  
사고 재확인 모델의 100% 정확도를 입증했습니다.

> 현재 수리이력 관리 시스템과 **사고 탐지 시스템 간 연계를 위한 사전 인프라 통합 중**이며,  
> **장비 고장 ↔ 사고 이력 간 상관관계 분석**까지 발전시킬 계획입니다.

---

## 🌱 향후 계획

- 수리 빈도 기반 부품 수명 예측 기능 개발  
- 사용자 대시보드 시각화  
- 복지 예산 자동 집계 기능 추가  
- 공개 API 제공 및 타 기관 확산 검토

---

<div align="center">
  
  ## 🔗 Related Resources
  
  | 📘 [Notion Project Page](https://jaeman-hyu.notion.site/1c4ec4b6449b80bca4f2d6413eb7e8ef?pvs=74) | 🧾 [Presentation PDF(중간발표)](https://github.com/user-attachments/files/20057505/-.pdf)|
  |:---:|:---:|
</div>  

---  
<br>
<br>
<br>
<br>
<br>
<br>

# <a name="api"></a>📘 API 명세서 (비개발자용) - Soorisoori 시스템

모든 API는 Firebase 로그인 이후에만 사용할 수 있습니다. 각 요청은 "사용자가 누굴까?"를 확인하기 위해 로그인 정보가 필요합니다.

---

## 🔐 1. 사용자 역할 조회

- **주소**: `/auth/role`
- **방식**: GET
- **설명**: 로그인한 사용자의 역할(role)을 알려줍니다.
- **성공 예시**:
```json
{ "role": "user" }
```
- **실패 상황**: 로그인 정보가 잘못되었거나, 사용자가 존재하지 않음

---

## 👤 2. 사용자 등록 (차량과 연결)

- **주소**: `/users/{vehicleId}`
- **방식**: POST
- **설명**: 사용자를 새로 등록하고, 차량과 연결합니다.
- **필수 정보 (Body 안에 포함)**:
  - 이름(name)
  - 차량 모델명(model)
  - 구매일자(purchasedAt) → 예: "2024-01-10T00:00:00.000Z"
  - 등록일자(registeredAt)
  - 수신자 유형(recipientType) → 예: "user"
- **성공 예시**:
```json
{ "userId": "...", "name": "홍길동", "phoneNumber": "01012345678", "role": "user", "recipientType": "user", "vehicleId": "abcd-1234" }
```
- **실패 상황**:
  - 해당 차량이 존재하지 않음
  - 이미 해당 차량은 누군가가 등록함
  - 이미 사용자로 등록된 전화번호임
  - 로그인 정보가 유효하지 않음

---

## 🚘 3. 차량 정보 조회

- **주소**: `/vehicles/{vehicleId}`
- **방식**: GET
- **설명**: 차량에 연결된 사용자 정보와 기본 차량 정보를 확인합니다.
- **성공 예시**:
```json
{ "userId": "사용자 ID (없을 수도 있음)", "vehicleId": "abcd-1234", "model": "휠체어 3000", "purchasedAt": "2024-01-10T00:00:00.000Z", "registeredAt": "2024-02-10T00:00:00.000Z" }
```
- **실패 상황**:
  - 차량 ID가 잘못됨
  - 로그인한 사람이 해당 차량의 주인이 아님

---

## 🛠️ 4. 수리 이력 조회

- **주소**: `/repairs/{vehicleId}`
- **방식**: GET
- **설명**: 차량의 모든 수리 내역을 가져옵니다. 가장 최근 수리가 먼저 나옵니다.
- **성공 예시**:
```json
[ { "repairer": "홍수리기사", "repairStationCode": "ST01", "repairStationLabel": "강남수리센터", "repairedDate": "2024-12-12T00:00:00.000Z", "billingPrice": 15000, "isAccident": false, "repairCategories": ["타이어", "기타"], "batteryVoltage": 36.5, "etcRepairParts": "배터리 교체", "memo": "비상 수리" } ]
```
- **실패 상황**:
  - 차량 ID가 잘못됨
  - 로그인한 사람이 해당 차량의 주인이 아님
  - 로그인 정보가 유효하지 않음

---

## 🛠️ 5. 수리 이력 등록

- **주소**: `/repairs/{vehicleId}`
- **방식**: POST
- **설명**: 차량의 새로운 수리 정보를 등록합니다.
- **필수 정보**:
  - 수리일자 (`repairedDate`)
  - 수리비 (`billingPrice`)
  - 사고 여부 (`isAccident`: true/false)
  - 수리 항목 목록 (`repairCategories`: 예: ["타이어", "기타"])
  - 배터리 전압 (`batteryVoltage`)
  - 수리공 이름 (`repairer`)
  - 기타 부품 이름 (`etcRepairParts`, 선택)
  - 메모 (`memo`, 선택)
- **성공 예시**:
```json
{ "_id": "자동생성된수리ID", ... }
```
- **실패 상황**:
  - 필수 항목이 빠졌거나 형식이 틀림
  - 수리자가 아님
  - 서버 오류

---

## 🧭 6. 수리센터 목록 조회

- **주소**: `/repair-stations`
- **방식**: GET
- **설명**: 전국 수리센터의 목록을 가져옵니다. 위치 좌표도 포함되어 있어 지도에 표시할 수 있습니다.
- **성공 예시**:
```json
{ "stations": [ { "code": "ST01", "state": "서울특별시", "city": "강남구", "region": "역삼동", "address": "서울시 강남구 테헤란로 123", "label": "강남보장구수리센터", "telephone": "02-1234-5678", "coordinate": [127.12345, 37.12345] } ] }
```
- **실패 상황**:
  - 서버 오류

---

## 📌 인증 공통 사항

- 모든 API 요청은 로그인 후 발급된 토큰을 사용해야 합니다.
- 예시:  
```
Authorization: Bearer <로그인한 사용자 토큰>
```
- 브라우저에서는 자동 처리되며, 외부에서 테스트할 경우 위의 형식을 헤더에 추가합니다.

---  
<br>
<br>
<br>
<br>
<br>
<br>

# <a name="db"></a>🗂️ Soorisoori MongoDB 스키마 명세서 (비개발자용)

이 문서는 Soorisoori 시스템에서 사용하는 데이터베이스 컬렉션 구조를 비개발자도 이해할 수 있도록 설명한 자료입니다. 각 "컬렉션"은 일종의 테이블이며, 각각 사용자, 차량, 수리기록, 수리센터, 보호자 정보를 담고 있습니다.

---

## 👤 Users (사용자)

### 설명
앱에 로그인한 사용자 (장비 소유자). 한 명의 사용자는 여러 대의 차량이나 보호자와 연결될 수 있습니다.

### 주요 필드
| 필드명 | 설명 | 예시 |
|--------|------|------|
| firebaseUid | Firebase에서 제공하는 사용자 고유 ID | "abcd1234" |
| name | 사용자 이름 | "홍길동" |
| phoneNumber | 전화번호 | "01012345678" |
| role | 사용자 역할 | "user" / "admin" / "repairer" / "guardian" |
| recipientType | 수신자 유형 | "general" / "disabled" / "lowIncome" |
| guardianIds | 연결된 보호자 ID 목록 | ["ObjectId1", "ObjectId2"] |

---

## 🚘 Vehicles (차량)

### 설명
전동보장구(휠체어 등)의 정보를 담고 있는 컬렉션입니다. 각 차량은 특정 사용자와 연결됩니다.

### 주요 필드
| 필드명 | 설명 | 예시 |
|--------|------|------|
| vehicleId | 차량 고유 ID | "VH123456" |
| userId | 이 차량을 사용하는 사용자 ID | "ObjectId" |
| model | 차량 모델명 | "휠체어-3000" |
| purchasedAt | 구매 일자 | "2023-01-10T00:00:00.000Z" |
| registeredAt | 등록 일자 | "2023-02-01T00:00:00.000Z" |

---

## 🛠 Repairs (수리 기록)

### 설명
차량의 수리 이력을 기록하는 컬렉션입니다. 수리는 차량 단위로 등록됩니다.

### 주요 필드
| 필드명 | 설명 | 예시 |
|--------|------|------|
| vehicleId | 수리한 차량 ID (Vehicles 컬렉션 참조) | "ObjectId" |
| repairedDate | 수리 날짜 | "2024-12-12T00:00:00.000Z" |
| billingPrice | 수리 비용 | 15000 |
| isAccident | 사고 여부 | true / false |
| repairStationCode | 수리센터 코드 | "ST01" |
| repairStationLabel | 수리센터 이름 | "강남센터" |
| repairer | 수리 기사 이름 | "김정비" |
| repairCategories | 수리 항목 | "타이어, 배터리" |
| batteryVoltage | 배터리 전압 | 36.5 |
| etcRepairParts | 기타 부품 내용 | "전선 교체" |
| memo | 메모 | "긴급 수리 요청" |

---

## 🧭 RepairStations (수리센터)

### 설명
전국 수리센터의 정보 및 위치 좌표를 포함하는 컬렉션입니다. 지도 연동에 활용됩니다.

### 주요 필드
| 필드명 | 설명 | 예시 |
|--------|------|------|
| code | 수리센터 고유 코드 | "ST01" |
| firebaseUid | 수리센터 관리자 Firebase UID | "xyz123" |
| label | 수리센터 명칭 | "강남보장구수리센터" |
| state | 시/도 | "서울특별시" |
| city | 시/군/구 | "강남구" |
| region | 지역 | "역삼동" |
| address | 상세주소 | "서울시 강남구 테헤란로 123" |
| telephone | 전화번호 | "02-1234-5678" |
| coordinate | 위치 정보 (경도, 위도) | [127.0276, 37.4979] |

> 🧭 `coordinate`는 GeoJSON 형식의 포인트(Point)로 저장되며, 지도 검색에 사용됩니다.

---

## 👥 Guardians (보호자)

### 설명
사용자를 보조하는 보호자 정보를 담고 있습니다. 보호자는 사용자 1명과 연결됩니다.

### 주요 필드
| 필드명 | 설명 | 예시 |
|--------|------|------|
| firebaseUid | 보호자 Firebase UID | "abcd9876" |
| userId | 연결된 사용자 ID | "ObjectId" |

---

## 📌 컬렉션 간 관계 요약

- `Users` 1 ↔ N `Vehicles` (1명의 사용자는 여러 대의 차량을 가질 수 있음)
- `Vehicles` 1 ↔ N `Repairs` (1대의 차량은 여러 번 수리될 수 있음)
- `Users` 1 ↔ N `Guardians` (보호자는 사용자를 보조)
- `Repairs` N ↔ 1 `RepairStations` (수리는 하나의 센터에서 발생함)

---

## ⛓ 관계도 요약 예시 (자연어)

- "홍길동" 사용자는 `휠체어 A`와 연결되어 있고,  
  이 휠체어는 2024년 3월에 "강남보장구수리센터"에서 수리를 받았으며,  
  보호자 계정이 1개 연결되어 있다.

---

## 🧩 DB 연결 정보 (서버에서만 사용됨)

- 데이터베이스는 MongoDB Atlas를 사용하며, 연결 주소는 환경변수(`.env`)로 관리됩니다.
- 예시 형식:
```
mongodb+srv://[사용자명]:[비밀번호]@[클러스터주소]/[DB명]?retryWrites=true&w=majority
```

---
#### [맨 위로 이동](#top)
#### [API 명세서(비개발자용](#api)
#### [DB 스키마 명세서(비개발자용](#db)
